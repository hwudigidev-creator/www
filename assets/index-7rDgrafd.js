var F=Object.defineProperty;var G=(d,n,e)=>n in d?F(d,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):d[n]=e;var g=(d,n,e)=>G(d,typeof n!="symbol"?n+"":n,e);import{P as m}from"./phaser-0RJB29YE.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function e(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(t){if(t.ep)return;t.ep=!0;const s=e(t);fetch(t.href,s)}})();class D extends m.Scene{constructor(){super("BootScene")}preload(){}create(){const n=this.cameras.main.width,e=this.cameras.main.height;this.add.text(n/2,e/2,"Loading...",{font:"20px monospace",color:"#ffffff"}).setOrigin(.5,.5),this.scene.start("MainScene")}}class N extends m.Scene{constructor(){super("MainScene")}create(){const n=this.cameras.main.width,e=this.cameras.main.height;this.add.text(n/2,e/2,`DDT Web Game
Phaser 3 + Vite`,{font:"40px Arial",color:"#ffffff",align:"center"}).setOrigin(.5,.5);const i=this.add.circle(n/2,e/2+100,50,16711680);i.setInteractive(),i.on("pointerdown",()=>{i.setFillStyle(65280)}),i.on("pointerup",()=>{i.setFillStyle(16711680)})}}class R extends m.Scene{constructor(){super("GridScene");g(this,"cells",[]);g(this,"cols",0);g(this,"rows",0);g(this,"cellSize",10);g(this,"gap",1);g(this,"isAnimating",!1)}create(){this.createGrid(),this.startEntryAnimation(),this.input.on("pointerdown",e=>{if(this.isAnimating)return;const i=Math.floor(e.x/(this.cellSize+this.gap)),t=Math.floor(e.y/(this.cellSize+this.gap));this.startExitAnimation(i,t)})}createGrid(){const e=this.cameras.main.width,i=this.cameras.main.height;this.cols=Math.ceil(e/(this.cellSize+this.gap)),this.rows=Math.ceil(i/(this.cellSize+this.gap));for(let t=0;t<this.rows;t++)for(let s=0;s<this.cols;s++){const r=s*(this.cellSize+this.gap)+this.cellSize/2,p=t*(this.cellSize+this.gap)+this.cellSize/2,a=this.add.rectangle(r,p,this.cellSize,this.cellSize,2236962);a.setAlpha(0),this.cells.push({x:s,y:t,graphics:a,delay:0})}}startEntryAnimation(){this.isAnimating=!0;const e=new Set;for(let o=0;o<this.cells.length;o++)e.add(o);const i=20,t=50,s=10,p=Math.floor(200/s),a=3e3;let l=0,S=!1;const v=(o,f)=>f*this.cols+o,I=o=>({x:o%this.cols,y:Math.floor(o/this.cols)}),O=o=>{const f=this.cells[o];f.graphics.setAlpha(1),f.graphics.setFillStyle(16777215),this.tweens.add({targets:f.graphics,fillColor:{from:16777215,to:2236962},duration:80,ease:"Linear"})},P=o=>{const{x:f,y:w}=I(o),h=p,u=[];for(let c=0;c<=h;c++)u[c]=[];for(let c=-h;c<=h;c++)for(let y=-h;y<=h;y++){const A=f+y,M=w+c;if(A>=0&&A<this.cols&&M>=0&&M<this.rows){const L=Math.sqrt(y*y+c*c),z=Math.floor(L);if(z<=h){const b=v(A,M);u[z].push(b)}}}let x=0;const C=()=>{x>h||(u[x].forEach(c=>{e.has(c)&&(e.delete(c),O(c))}),x++,x<=h&&this.time.delayedCall(s,C))};C()},E=()=>{if(S)return;if(l>=a||e.size===0){this.finishEntry(e),S=!0;return}const o=Array.from(e),f=Math.min(i,o.length);for(let w=0;w<f&&o.length!==0;w++){const h=Math.floor(Math.random()*o.length),u=o[h];o.splice(h,1),e.has(u)&&P(u)}l+=t,e.size>0&&l<a?this.time.delayedCall(t,E):S||(this.finishEntry(e),S=!0)};E()}finishEntry(e){e.forEach(i=>{const t=this.cells[i];t.graphics.setAlpha(1),t.graphics.setFillStyle(2236962)}),this.time.delayedCall(100,()=>{this.isAnimating=!1})}startExitAnimation(e,i){this.isAnimating=!0;const t=5;let s=0;this.cells.forEach(r=>{const p=r.x-e,a=r.y-i,l=Math.sqrt(p*p+a*a);r.delay=Math.floor(l*t),r.delay>s&&(s=r.delay)}),this.cells.forEach(r=>{this.time.delayedCall(r.delay,()=>{this.tweens.addCounter({from:0,to:100,duration:150,ease:"Power1",onUpdate:p=>{const a=p.getValue()??0;let l;a<20?l=16777215:a<40?l=16776960:a<60?l=16746496:a<80?l=16720384:l=4456448,r.graphics.setFillStyle(l),r.graphics.setAlpha(1-a/100*.8)},onComplete:()=>{r.graphics.setAlpha(0)}})})}),this.time.delayedCall(s+200,()=>{this.scene.start("MainScene")})}}const T={type:m.AUTO,width:window.innerWidth,height:window.innerHeight,parent:"app",backgroundColor:"#111111",scale:{mode:m.Scale.RESIZE,autoCenter:m.Scale.CENTER_BOTH},physics:{default:"arcade",arcade:{gravity:{x:0,y:0},debug:!1}},scene:[R,D,N]};new m.Game(T);
